(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["upload"],{1681:function(t,e,a){},2679:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-form",{model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-container",[a("v-progress-linear",{directives:[{name:"show",rawName:"v-show",value:t.uploading,expression:"uploading"}],attrs:{value:t.uploadProgress}}),a("v-row",{attrs:{cols:"12",md:"4"}},[a("div",{staticClass:"image-container"},[a("img",{ref:"cameraImg",attrs:{src:t.imageSource}})])]),a("v-row",{attrs:{cols:"12",md:"4"}},[a("v-text-field",{attrs:{rules:t.titleRules,counter:30,label:"Titel",required:""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),a("v-row",{attrs:{cols:"12",md:"4"}},[a("v-textarea",{attrs:{rules:t.descriptionRules,counter:200,label:"Beschreibung",required:""},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1),a("div",{staticClass:"actions"},[a("v-btn",{attrs:{small:"",text:""},on:{click:function(e){return e.stopPropagation(),t.cancel(e)}}},[t._v("Abbrechen")]),a("v-spacer"),a("v-btn",{attrs:{color:"primary",disabled:!t.valid,loading:t.uploading},on:{click:function(e){return e.stopPropagation(),t.upload(e)}}},[t._v("Hochladen")])],1)],1)],1)],1)},n=[],r=(a("a4d3"),a("e01a"),a("0d03"),a("d3b7"),a("ac1f"),a("25f0"),a("5319"),a("3b38")),i=a("bc76"),s=a("2147"),u=a("59ca"),c=a.n(u),l=(a("2e66"),{storageRef:c.a.storage().ref()}),d={name:"upload",data:function(){return{title:null,description:null,valid:!1,uploading:!1,uploadTask:null,uploadProgress:0,titleRules:[function(t){return!!t||"Titel erforderlich"}],descriptionRules:[function(t){return!!t||"Beschreibung erforderlich"}]}},computed:{imageSource:function(){return"data:image/jpeg;base64,".concat(r["a"].capturedImage)}},methods:{upload:function(){this.uploading=!0,this.uploadImage()},uploadPost:function(t){var e=this;this.loading=!0,i["a"].db.ref("posts").push({title:e.title,description:e.description,image:t,uid:s["a"].getUserId()}).then((function(){e.$emit("successMsg","Post gespeichert"),e.$router.push("/"),e.loading=!1}),(function(t){e.$emit("errorMsg","Fehler: ".concat(t))}))},uploadImage:function(){var t=l.storageRef,e=t.child("posts/".concat(this.uuidv4(),".jpg")),a=this;this.uploadTask=e.putString(this.imageSource,"data_url"),this.uploadTask.on("state_changed",this.imageUploading,(function(t){return a.$emit("errorMsg","Fehler: ".concat(t))}),this.imageUploaded)},imageUploading:function(t){var e=t.bytesTransferred/t.totalBytes*100;switch(console.log(e),this.uploadProgress=e,t.state){case c.a.storage.TaskState.PAUSED:console.log("Upload is paused");break;case c.a.storage.TaskState.RUNNING:console.log("Upload is running");break}},imageUploaded:function(){var t=this,e=this;setTimeout((function(){t.uploading=!1}),500),this.uploadTask.snapshot.ref.getDownloadURL().then((function(t){e.uploadPost(t)}))},uuidv4:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0,a="x"===t?e:3&e|8;return a.toString(16)}))},cancel:function(){this.$router.push("/")}},mounted:function(){}},p=d,h=(a("7b13"),a("2877")),g=a("6544"),f=a.n(g),m=a("8336"),v=a("a523"),b=a("4bd4"),x=a("8e36"),w=a("0fd9"),y=a("2fa4"),k=a("8654"),I=(a("4de4"),a("4160"),a("a9e3"),a("e439"),a("dbb4"),a("b64b"),a("acd8"),a("e25e"),a("159b"),a("ade3")),O=(a("1681"),a("58df"));function P(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function j(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?P(Object(a),!0).forEach((function(e){Object(I["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var T=Object(O["a"])(k["a"]),R=T.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:function(t){return!isNaN(parseFloat(t))}},rows:{type:[Number,String],default:5,validator:function(t){return!isNaN(parseInt(t,10))}}},computed:{classes:function(){return j({"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle},k["a"].options.computed.classes.call(this))},noResizeHandle:function(){return this.noResize||this.autoGrow}},watch:{lazyValue:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted:function(){var t=this;setTimeout((function(){t.autoGrow&&t.calculateInputHeight()}),0)},methods:{calculateInputHeight:function(){var t=this.$refs.input;if(t){t.style.height="0";var e=t.scrollHeight,a=parseInt(this.rows,10)*parseFloat(this.rowHeight);t.style.height=Math.max(a,e)+"px"}},genInput:function(){var t=k["a"].options.methods.genInput.call(this);return t.tag="textarea",delete t.data.attrs.type,t.data.attrs.rows=this.rows,t},onInput:function(t){k["a"].options.methods.onInput.call(this,t),this.autoGrow&&this.calculateInputHeight()},onKeyDown:function(t){this.isFocused&&13===t.keyCode&&t.stopPropagation(),this.$emit("keydown",t)}}}),S=Object(h["a"])(p,o,n,!1,null,"5bb23cf1",null);e["default"]=S.exports;f()(S,{VBtn:m["a"],VContainer:v["a"],VForm:b["a"],VProgressLinear:x["a"],VRow:w["a"],VSpacer:y["a"],VTextField:k["a"],VTextarea:R})},"3b38":function(t,e,a){"use strict";e["a"]={capturedImage:null,setCapturedImage:function(t){this.capturedImage=t}}},"7b13":function(t,e,a){"use strict";var o=a("f9fa"),n=a.n(o);n.a},f9fa:function(t,e,a){}}]);
//# sourceMappingURL=upload.7fd2ff9c.js.map